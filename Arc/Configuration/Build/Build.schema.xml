<?xml version="1.0" encoding="utf-8"?>
<project name="Schema" default="BuildSchema">

  <!-- Properties -->
  
  <!-- Main target -->
  <target name="BuildSchema" description="Builds project schema">
    <property name="verbosity" value="quiet" />
    <property name="verbosity" value="normal" if="${verbose}" />

    <property name="schema.database.data.path.exists" value="${string::get-length(property::get-value('schema.database.data.path')) > 0}" />
    <property name="schema.database.connection_string.exists" value="${string::get-length(property::get-value('schema.database.connection_string')) > 0}" />
    <property name="schema.database.name.exists" value="${string::get-length(property::get-value('schema.database.name')) > 0}" />

    <exec program="${path.msbuild.console}">
      <arg value="/target:Rebuild,Deploy,DataGeneration" />
      <arg value="/property:TargetDatabase=${schema.database.name}"
			   if="${schema.database.name.exists}" />
      <arg value='/property:TargetConnectionString="${schema.database.connection_string}"'
			   if="${schema.database.connection_string.exists}" />
      <arg value='/property:DefaultDataPath="${schema.database.data.path}"'
			   if="${schema.database.data.path.exists}" />
      <arg value='/property:SourceFile="${project.schema.path}/${project.schema}/Data Generation Plans/Test.dgen"' />
      <arg value="/verbosity:${verbosity}" />
      <arg value="/nologo" />
      <arg path="${project.schema.path}/${project.schema}/${project.schema}.dbproj" />
    </exec>

  </target>
  
</project>